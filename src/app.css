@tailwind base;
@tailwind components;
@tailwind utilities;

/* Custom JetBrains Mono Font Loading */
@font-face {
  font-family: 'JetBrains Mono';
  src: url('/fonts/JetBrainsMono-Regular.woff2') format('woff2');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'JetBrains Mono';
  src: url('/fonts/JetBrainsMono-Italic.woff2') format('woff2');
  font-weight: 400;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: 'JetBrains Mono';
  src: url('/fonts/JetBrainsMono-Medium.woff2') format('woff2');
  font-weight: 500;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'JetBrains Mono';
  src: url('/fonts/JetBrainsMono-MediumItalic.woff2') format('woff2');
  font-weight: 500;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: 'JetBrains Mono';
  src: url('/fonts/JetBrainsMono-SemiBold.woff2') format('woff2');
  font-weight: 600;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'JetBrains Mono';
  src: url('/fonts/JetBrainsMono-SemiBoldItalic.woff2') format('woff2');
  font-weight: 600;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: 'JetBrains Mono';
  src: url('/fonts/JetBrainsMono-Bold.woff2') format('woff2');
  font-weight: 700;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'JetBrains Mono';
  src: url('/fonts/JetBrainsMono-BoldItalic.woff2') format('woff2');
  font-weight: 700;
  font-style: italic;
  font-display: swap;
}

@layer base {
  html {
    font-family: 'JetBrains Mono', 'Univers', 'Inter', system-ui, sans-serif;
  }
  
  body {
    @apply bg-nord-0 text-nord-4;
  }
}

@layer components {
  .tag-notation {
    /* Use monospace for Firefox, JetBrains Mono for other browsers */
    font-family: 'JetBrains Mono', monospace;
    @apply text-lg text-nord-4;
    line-height: 2.0;
    font-feature-settings: "liga" 0, "kern" 1, "mark" 1;
    font-variant-ligatures: none;
    text-rendering: optimizeLegibility;
    unicode-bidi: normal;
    direction: ltr;
    font-size: 1.2em;
    /* Firefox-specific fixes for Unicode combining characters */
    -moz-font-feature-settings: "liga" 0, "kern" 1, "mark" 1;
    -moz-text-rendering: optimizeLegibility;
    -webkit-font-feature-settings: "liga" 0, "kern" 1, "mark" 1;
    -webkit-text-rendering: optimizeLegibility;
  }
  
  /* Firefox-specific font override */
  @-moz-document url-prefix() {
    .tag-notation {
      font-family: monospace;
    }
  }
  
  .tag-notation pre {
    @apply font-mono text-base whitespace-pre-wrap break-words text-nord-4;
    line-height: 2.2;
    font-variant-ligatures: none;
    text-rendering: optimizeLegibility;
    font-feature-settings: "liga" 0, "kern" 1, "mark" 1;
    unicode-bidi: normal;
    direction: ltr;
    font-size: 1.1em;
    letter-spacing: 0.05em;
    /* Firefox-specific fixes for Unicode combining characters */
    -moz-font-feature-settings: "liga" 0, "kern" 1, "mark" 1;
    -moz-text-rendering: optimizeLegibility;
    -webkit-font-feature-settings: "liga" 0, "kern" 1, "mark" 1;
    -webkit-text-rendering: optimizeLegibility;
    /* Force Firefox to use proper Unicode normalization */
    -moz-unicode-bidi: normal;
    -moz-font-smoothing: antialiased;
    font-kerning: none;
    font-variant-numeric: normal;
    /* Additional spacing for combining characters in Firefox */
    padding: 0.2em 0;
    /* Firefox-specific line height */
    -moz-line-height: 2.2;
    /* Force Firefox to render combining characters properly */
    -moz-transform: translateZ(0);
    transform: translateZ(0);
  }
  
  /* Staff section styling - prevents breaking within musical staffs */
  .staff-section {
    @apply font-mono text-nord-4;
    line-height: 2.2;
    font-variant-ligatures: none;
    text-rendering: optimizeLegibility;
    font-feature-settings: "liga" 0, "kern" 1, "mark" 1;
    unicode-bidi: normal;
    direction: ltr;
    font-size: 1.1em;
    letter-spacing: 0.05em;
    /* Prevent breaking within staff sections */
    page-break-inside: avoid;
    break-inside: avoid;
    /* Firefox-specific fixes */
    -moz-font-feature-settings: "liga" 0, "kern" 1, "mark" 1;
    -moz-text-rendering: optimizeLegibility;
    -webkit-font-feature-settings: "liga" 0, "kern" 1, "mark" 1;
    -webkit-text-rendering: optimizeLegibility;
    -moz-unicode-bidi: normal;
    -moz-font-smoothing: antialiased;
    font-kerning: none;
    font-variant-numeric: normal;
    padding: 0.2em 0;
    -moz-line-height: 2.2;
    -moz-transform: translateZ(0);
    transform: translateZ(0);
    /* Staff sections stack vertically */
    display: block;
    margin-bottom: 1.5em;
    min-width: fit-content;
  }
  
  .voice-line {
    @apply font-mono;
    line-height: 2.2;
    font-variant-ligatures: none;
    text-rendering: optimizeLegibility;
    font-feature-settings: "liga" 0, "kern" 1, "mark" 1;
    unicode-bidi: normal;
    direction: ltr;
    letter-spacing: 0.05em;
    /* Prevent breaking within individual voice lines */
    white-space: nowrap;
    /* Firefox-specific fixes */
    -moz-font-feature-settings: "liga" 0, "kern" 1, "mark" 1;
    -moz-text-rendering: optimizeLegibility;
    -webkit-font-feature-settings: "liga" 0, "kern" 1, "mark" 1;
    -webkit-text-rendering: optimizeLegibility;
    -moz-unicode-bidi: normal;
    -moz-font-smoothing: antialiased;
    font-kerning: none;
    font-variant-numeric: normal;
    -moz-line-height: 2.2;
    -moz-transform: translateZ(0);
    transform: translateZ(0);
  }
  
  .lyrics-line {
    @apply font-mono;
    line-height: 2.2;
    font-variant-ligatures: none;
    text-rendering: optimizeLegibility;
    font-feature-settings: "liga" 0, "kern" 1, "mark" 1;
    unicode-bidi: normal;
    direction: ltr;
    letter-spacing: 0.05em;
    /* Lyrics can wrap but should stay together */
    white-space: pre-wrap;
    /* Firefox-specific fixes */
    -moz-font-feature-settings: "liga" 0, "kern" 1, "mark" 1;
    -moz-text-rendering: optimizeLegibility;
    -webkit-font-feature-settings: "liga" 0, "kern" 1, "mark" 1;
    -webkit-text-rendering: optimizeLegibility;
    -moz-unicode-bidi: normal;
    -moz-font-smoothing: antialiased;
    font-kerning: none;
    font-variant-numeric: normal;
    -moz-line-height: 2.2;
    -moz-transform: translateZ(0);
    transform: translateZ(0);
    /* Slight indent for lyrics */
    margin-left: 0.5em;
    margin-top: 0.2em;
  }
  
  /* Mobile-specific optimizations for tag notation */
  @media (max-width: 640px) {
    .tag-notation {
      font-size: 1.0em;
      line-height: 2.0;
      letter-spacing: 0.03em;
    }
    
    .tag-notation pre {
      font-size: 1.0em;
      line-height: 2.0;
      letter-spacing: 0.03em;
      /* Prevent horizontal scrolling on very long lines */
      word-break: break-all;
      overflow-wrap: break-word;
    }
    
    .staff-section {
      font-size: 1.0em;
      line-height: 2.0;
      letter-spacing: 0.03em;
      /* Allow horizontal scrolling for very long staffs on mobile */
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }
    
    .voice-line {
      font-size: 1.0em;
      line-height: 2.0;
      letter-spacing: 0.03em;
    }
    
    .lyrics-line {
      font-size: 1.0em;
      line-height: 2.0;
      letter-spacing: 0.03em;
    }
  }
  
  /* Tablet optimizations */
  @media (min-width: 641px) and (max-width: 1024px) {
    .tag-notation {
      font-size: 1.0em;
      line-height: 1.9;
    }
    
    .tag-notation pre {
      font-size: 1.0em;
      line-height: 1.9;
    }
    
    .staff-section {
      font-size: 1.0em;
      line-height: 1.9;
    }
    
    .voice-line {
      font-size: 1.0em;
      line-height: 1.9;
    }
    
    .lyrics-line {
      font-size: 1.0em;
      line-height: 1.9;
    }
  }
  
  /* Firefox-specific font override for pre elements */
  @-moz-document url-prefix() {
    .tag-notation pre {
      font-family: monospace;
    }
  }
  
  .search-input {
    @apply w-full px-4 py-3 border border-nord-5 rounded focus:ring-2 focus:ring-nord-8 focus:border-transparent bg-nord-1 text-nord-4 placeholder-nord-5;
  }
  
  .btn-primary {
    @apply bg-nord-8 hover:bg-nord-9 text-nord-0 font-medium py-2 px-4 rounded transition-colors duration-200;
  }
  
  .btn-secondary {
    @apply bg-nord-2 hover:bg-nord-3 text-nord-4 font-medium py-2 px-4 rounded transition-colors duration-200;
  }
  
  /* Card backgrounds */
  .card-bg {
    @apply bg-nord-1 border-nord-2;
  }
  
  /* Text colors - all using Snow Storm for better readability */
  .text-primary {
    @apply text-nord-4;
  }
  
  .text-secondary {
    @apply text-nord-4;
  }
  
  .text-muted {
    @apply text-nord-5;
  }
  
  /* Dropdown arrow */
  select {
    /* Hide default arrow */
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    
    /* Add custom arrow */
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%23e5e9f0' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
    background-position: right 0.75rem center;
    background-repeat: no-repeat;
    background-size: 1.5em 1.5em;
    padding-right: 3rem !important;
  }
}